{% comment %}
  Custom Review Widget
  
  A reusable widget that displays a single customer review with quotation marks and customer name below
  Designed to replace Judge.me testimonial carousels with a cleaner, simpler design
  
  Parameters:
  - review_text: The review text content (English/default)
  - review_text_fi: Finnish translation of the review (optional)
  - review_text_de: German translation of the review (optional)
  - customer_name: The name of the reviewer
  - background_color: Optional background color (defaults to #f2eee2)
  - text_color: Optional text color (defaults to #000000)
  
  Usage: 
  {% render 'custom-review-widget', 
     review_text: "Your review text here", 
     review_text_fi: "Arviointi suomeksi",
     review_text_de: "Bewertung auf Deutsch",
     customer_name: "Customer Name" %}
{% endcomment %}

{% assign review_text = review_text | default: '' %}
{% assign review_text_fi = review_text_fi | default: '' %}
{% assign review_text_de = review_text_de | default: '' %}
{% assign customer_name = customer_name | default: '' %}
{% assign background_color = background_color | default: '#f2eee2' %}
{% assign text_color = text_color | default: '#000000' %}

{% comment %} Determine which review text to show based on current language {% endcomment %}
{% assign current_language = localization.language.iso_code %}
{% assign final_review_text = review_text %}

{% case current_language %}
  {% when 'fi' %}
    {% if review_text_fi != blank %}
      {% assign final_review_text = review_text_fi %}
    {% endif %}
  {% when 'de' %}
    {% if review_text_de != blank %}
      {% assign final_review_text = review_text_de %}
    {% endif %}
  {% else %}
    {% assign final_review_text = review_text %}
{% endcase %}

{% if final_review_text != blank %}
<div class="custom-review-widget" style="background-color: {{ background_color }}; color: {{ text_color }};">
  <div class="custom-review-content">
    <div class="custom-review-text">
      <span class="quote-mark quote-open">"</span>
      <span class="review-content">{{ final_review_text }}</span>
      <span class="quote-mark quote-close">"</span>
    </div>
    {% if customer_name != blank %}
    <div class="custom-review-author">
      {{ customer_name }}
    </div>
    {% endif %}
  </div>
</div>
{% endif %}

<style>
  .custom-review-widget {
    width: 100%;
    max-width: 1100px;
    margin: 0 auto;
    padding: 32px 24px;
    border-radius: 8px;
    font-family: var(--font-body-family, 'Acumin Pro Condensed', sans-serif);
    line-height: 1.5;
  }

  .custom-review-content {
    text-align: center;
  }

  .custom-review-text {
    font-size: 18px;
    font-weight: 400;
    margin-bottom: 16px;
    position: relative;
    display: block;
    width: 100%;
  }

  .quote-mark {
    font-size: 24px;
    font-weight: 700;
    color: #f3c002;
    margin: 0 2px;
  }

  .review-content {
    font-style: italic;
  }

  .custom-review-author {
    font-size: 16px;
    font-weight: 600;
    opacity: 0.8;
    margin-top: 12px;
    display: block;
    width: 100%;
  }

  /* Mobile responsiveness */
  @media screen and (max-width: 768px) {
    .custom-review-widget {
      padding: 24px 16px;
    }
    
    .custom-review-text {
      font-size: 16px;
    }
    
    .quote-mark {
      font-size: 20px;
      margin: 0 1px;
    }
    
    .custom-review-author {
      font-size: 14px;
    }
  }

  /* Ensure proper spacing in product page context */
  .main-product .custom-review-widget {
    margin-top: 0;
    margin-bottom: 24px;
  }

  /* Dark mode support */
  @media (prefers-color-scheme: dark) {
    .custom-review-widget {
      background-color: var(--color-background, #2a2a2a);
      color: var(--color-foreground, #ffffff);
    }
  }
</style>
